{% extends "core/dashboard_base.html" %}
{% block title %}Teacher Dashboard ‚Ä¢ College Core{% endblock %}

{% block topbar_left %}
  <div class="crumbs">–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å</div>
{% endblock %}

{% block content %}

<section class="page-head">
  <div>
    <h1 class="page-title">–ü—Ä–∏–≤–µ—Ç, {{ request.user.first_name|default:request.user.username }} üëã</h1>
    <p class="page-subtitle">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ, –≥—Ä—É–ø–ø—ã, –∫–æ–Ω—Ç—Ä–æ–ª—å –∑–∞–º–µ—á–∞–Ω–∏–π.</p>
  </div>
  <div class="pill">–û—Ç–∫—Ä—ã—Ç—ã—Ö –∑–∞–º–µ—á–∞–Ω–∏–π: <b>{{ open_remarks }}</b></div>
</section>

<section class="bento">
  <!-- Next lesson -->
  <article class="card big tilt" data-tilt>
    <div class="card-head">
      <h2 class="card-title">–°–ª–µ–¥—É—é—â–∞—è –ø–∞—Ä–∞</h2>
      {% if next_lesson %}
        <span class="pill">{{ next_lesson.group.code }} ‚Ä¢ {{ next_lesson.location }}</span>
      {% else %}
        <span class="pill">–ù–µ—Ç</span>
      {% endif %}
    </div>

    {% if next_lesson %}
      <div class="list">
        <div class="list-item">
          <div class="list-left" style="min-width:0;">
            <div class="dot"></div>
            <div style="min-width:0;">
              <div class="list-title">{{ next_lesson.subject.name }}</div>
              <div class="list-sub">
                {{ next_lesson.time_start }} ‚Äî {{ next_lesson.time_end }}
                ‚Ä¢ {{ next_lesson_start|date:"D, d M" }}
              </div>
            </div>
          </div>
          <span class="tag good">–°–∫–æ—Ä–æ</span>
        </div>

        <div class="list-item" data-countdown data-target-ms="{{ timestamp_ms }}">
          <div class="list-left">
            <div class="dot"></div>
            <div>
              <div class="list-title">–î–æ –Ω–∞—á–∞–ª–∞</div>
              <div class="list-sub muted">–û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É</div>
            </div>
          </div>
          <div class="list-meta" data-countdown-text>00:00:00</div>
        </div>
      </div>
    {% else %}
      <p class="muted">–ë–ª–∏–∂–∞–π—à–∏—Ö –ø–∞—Ä –Ω–µ—Ç.</p>
    {% endif %}

    <div class="card-actions">
      <a class="btn ghost" href="/schedule/">–û—Ç–∫—Ä—ã—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</a>
      <a class="btn ghost" href="/remarks/">–ó–∞–º–µ—á–∞–Ω–∏—è</a>
    </div>
  </article>

  <!-- Groups -->
  <article class="card tall tilt" data-tilt>
    <div class="card-head">
      <h2 class="card-title">–ú–æ–∏ –≥—Ä—É–ø–ø—ã</h2>
      <span class="pill">{{ groups|length }}</span>
    </div>

    <div class="list">
      {% for g in groups %}
        <div class="list-item">
          <div class="list-left">
            <div class="dot"></div>
            <div>
              <div class="list-title">{{ g.code }}</div>
              <div class="list-sub muted">–ì—Ä—É–ø–ø–∞</div>
            </div>
          </div>
          <span class="pill mini">OK</span>
        </div>
      {% empty %}
        <p class="muted">–ì—Ä—É–ø–ø –Ω–µ—Ç.</p>
      {% endfor %}
    </div>
  </article>

  <!-- Quick stats -->
  <article class="card tilt" data-tilt style="grid-column: span 6;">
    <div class="card-head">
      <h2 class="card-title">–ö–æ–Ω—Ç—Ä–æ–ª—å</h2>
      <span class="pill">Read-only</span>
    </div>

    <div class="kv">
      <div class="kv-row">
        <span class="kv-k">–û—Ç–∫—Ä—ã—Ç—ã—Ö –∑–∞–º–µ—á–∞–Ω–∏–π</span>
        <span class="kv-v">{{ open_remarks }}</span>
      </div>
      <div class="kv-row">
        <span class="kv-k">–ù–æ–≤–æ—Å—Ç–∏</span>
        <span class="kv-v">{{ news|length }}</span>
      </div>
    </div>

    <div class="card-actions">
      <a class="btn" href="/news/">–ù–æ–≤–æ—Å—Ç–∏</a>
      <a class="btn ghost" href="/homeworks/">–î–æ–º–∞—à–∫–∏</a>
    </div>
  </article>

  <!-- News -->
  <article class="card wide tilt" data-tilt>
    <div class="card-head">
      <h2 class="card-title">–ù–æ–≤–æ—Å—Ç–∏</h2>
      <a class="btn ghost" href="/news/">–í—Å–µ</a>
    </div>

    <div class="news-grid">
      {% for n in news %}
        <article class="news-card" style="display:grid;">
          <div class="news-img">
            {% if n.image %}
              <img src="{{ n.image.url }}" alt="{{ n.title }}">
            {% endif %}
          </div>
          <div class="news-body">
            <div class="news-title">{{ n.title }}</div>
            <div class="news-sub muted">{{ n.created_at|date:"d M Y" }}</div>
          </div>
        </article>
      {% empty %}
        <p class="muted">–ù–æ–≤–æ—Å—Ç–µ–π –Ω–µ—Ç.</p>
      {% endfor %}
    </div>
  </article>
</section>

{% endblock %}
